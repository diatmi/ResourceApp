<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="https://cdn.korzh.com/metroui/v4/css/metro-all.min.css">
  <link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css"
        rel="stylesheet"/>
  <title>ResourceApp</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300&display=swap" rel="stylesheet">
</head>
<body style="background-color: #003c8f">

<div style="display:flex; flex-direction: row; justify-content: left; align-items: start;">
  <h1 style="font-size: 60px; margin-left: 10px; color: black">Job Placement Services</h1>
  <select name="city" class="new-box-aqua p-2" id="citypicker" style="width: 250px; position: absolute; left: calc(100vw - 250px - 20px); top: 20px">
    <option value="Fremont" selected>Fremont, California</option>
    <option value="LosAngeles">Los Angeles, California</option>
    <option value="Newark">Newark, New Jersey</option>
    <option value="NewOrleans">New Orleans, Louisiana</option>
    <option value="SanFrancisco">San Francisco, California</option>
  </select>
</div>

<div id="cards" class="flex flex-no-wrap overflow-x-scroll scrolling-touch items-start mb-8 hide-scroll-bar"></div>

<script>
  function makeCard(imgLink, title, address, rating, totalRatings, webLink, phone) {
    if (phone == null) {
      phone = "Phone N/A";
    }
    return `
        <div class="card" style="margin: 12px; border-radius: 15px; border: none">
            <img class="card-img-top" src="${imgLink}" style="height: 180px;" onerror="this.onerror=null; this.src='assets/default.png'">
            <div class="card-body" style="height: 10rem;">
                <h5 class="card-title" style="color: white;">${title}</h5>
                <h6 class="card-subtitle mb-2 text-muted">${address}</h6>
                <div style="position: absolute; bottom: 0" >
                    <input data-stared-color="#5e92f3" data-role="rating" data-value="${rating}" data-message='<span style="color: #5e92f3;">(${totalRatings})</span>' data-static="true">
                </div>
            </div>
            <div class="card-body card-footer" style="border-bottom-left-radius: 15px; border-bottom-right-radius: 15px; border-color: #7953d2">
                <a href="${webLink}" class="btn btn-primary">Join</a>
                <a class="btn btn-secondary">${phone}</a>
            </div>
        </div>
        `
    // return `
    // <div class="col">
    // <div class="card mb-3" style="max-width: 520px;">
    //   <div class="row g-0">
    //     <div class="col-md-4">
    //       <img src="${imgLink}" class="img-fluid">
    //     </div>
    //     <div class="col-md-8">
    //       <div class="card-body">
    //         <h5 class="card-title">${title}</h5>
    //         <h6 class="card-subtitle mb-2 text-muted">${address}</h6>
    //         <input data-role="rating" data-value="${rating}" data-message="(${totalRatings})" data-static="true">
    //         <div class="card-body">
    //             <a href="${webLink}" class="btn btn-primary">Join</a>
    //             <a class="btn btn-secondary">${phone}</a>
    //         </div>
    //       </div>
    //     </div>
    //   </div>
    // </div>
    // </div>
    // `
  }

  function loadJSON(name) {
    name = "json files/Job Placement Services/" + name + ".json";
    fetch(name)
        .then(response => response.json())
        .then(data => {
          // get the div to put the cards in
          let div = document.getElementById("cards");
          // loop through the list data["local_results"]
          for (let i = 0; i < data["local_results"].length; i++) {
            // get the current item
            let item = data["local_results"][i];
            // make a card
            let card = makeCard(item["thumbnail"], item["title"], item["address"], item["rating"], item["reviews"], item["website"], item["phone"]);
            // add the card to the div
            div.innerHTML += card;
          }
        });
  }

  function clearCards() {
    let div = document.getElementById("cards");
    div.innerHTML = "";
  }

  document.getElementById('citypicker').onchange = function () {
    console.log("changed");
    clearCards();
    loadJSON(this.value);
  }

  loadJSON("Fremont");
</script>
<script src="https://cdn.korzh.com/metroui/v4/js/metro.min.js"></script>
</body>
</html>